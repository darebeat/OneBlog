(function(a){a.extend({notification:{isSupported:function(){return"Notification" in window},isPermissionGranted:function(){return Notification.permission==="granted"},requestPermission:function(){if(!this.isSupported()){return}Notification.requestPermission(function(c){var b=Notification.permission})},show:function(b){if(!this.isSupported()){return}if(!this.isPermissionGranted()){return}var e=a.extend({title:"您有一条新消息",icon:appConfig.staticPath+"/img/notification.png",delay:5000,notification:null},b);var d=new Notification(e.title,{icon:e.icon,noscreen:true,body:decodeURIComponent(e.notification)});var c=localStorage.getItem("hide");if(!c||parseInt(c)<new Date().getDate()){d.onshow=function(){setTimeout(function(){d.close()},e.delay)}}d.onclick=function(){d.close();localStorage.setItem("hide",new Date().getDate())};d.onerror=function(){};d.onclose=function(){}}}})})(jQuery);(function(a){a.extend({websocket:{_this:null,_initialized:false,init:function(c){if(!this.isSupported()){return}var d=a.extend({callback:function(){},host:null,reconnect:false},c);if(!d.host){return}try{this._this=new WebSocket(d.host)}catch(b){return}this._initialized=true;this._this.onerror=function(){};this._this.onopen=function(e){};this._this.onmessage=function(e){d.callback(e.data)};this._this.onclose=function(){a.websocket._initialized=false;if(d.reconnect){setTimeout(function(){a.websocket.open(d)},5000)}}},open:function(b){var c=a.extend({callback:function(){},host:null,reconnect:false},b);if(this._initialized){this.close()}this.init(b);window.onbeforeunload=function(){a.websocket.close()}},isSupported:function(){return"WebSocket" in window},send:function(b){if(!this._this){return}this._this.send(b)},close:function(){if(!this._this){return}this._this.close()}}})})(jQuery);(function(a){a.jqAlert=a.alert;a.jqConfirm=a.confirm;a.extend({alert:{info:function(c,e,d){d=d?"confirm|"+d:"confirm|3000";a.jqAlert({icon:"fa fa-info-circle",title:"友情提示",content:c,type:"green",typeAnimated:true,autoClose:d,buttons:{confirm:{text:"关闭",btnClass:"btn-default",action:e}}})},error:function(c,e,d){d=d?"confirm|"+d:"confirm|3000";a.jqAlert({icon:"fa fa-exclamation-circle",title:"警告",content:c,autoClose:d,type:"orange",typeAnimated:true,buttons:{confirm:{text:"关闭",btnClass:"btn-default",action:e}}})},confirm:function(d,f,c,e){e=e?"cancel|"+e:"cancel|5000";a.jqConfirm({icon:"fa fa-question-circle",title:"确认？",content:d,autoClose:e,type:"dark",typeAnimated:true,buttons:{confirm:{text:"确定",btnClass:"btn-green",action:f},cancel:{text:"取消",btnClass:"btn-default",action:c}}})},ajaxSuccessConfirm:function(c,d){if(c.status==200){if(c.message){a.alert.confirm(c.message,d)}}else{if(c.message){a.alert.error(c.message)}}},ajaxSuccess:function(c){if(c.status==200){if(c.message){a.alert.info(c.message)}}else{if(c.message){a.alert.error(c.message)}}},ajaxError:function(){a.alert.error("网络超时！")}}});a.extend({tool:{currentPath:function(){return window.location.pathname},random:function(d,c){return Math.floor((Math.random()*c)+d)},parseFormSerialize:function(g){var e={};if(!g){return null}var d=g.split("&");for(var f=0,c=d.length;f<c;f++){var h=d[f].split("=");e[h[0]]=decodeURIComponent(h[1])}return e}}});a.extend(String.prototype,{trim:function(){return this.replace(/(^\s*)|(\s*$)|\r|\n/g,"")},startsWith:function(c){return new RegExp("^"+c).test(this)},endsWith:function(c){return new RegExp(c+"$").test(this)},replaceAll:function(d,c){return this.replace(new RegExp(d,"gm"),c)}});a.extend(Date.prototype,{format:function(d){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(d)){d=d.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var c in e){if(new RegExp("("+c+")").test(d)){d=d.replace(RegExp.$1,RegExp.$1.length==1?e[c]:("00"+e[c]).substr((""+e[c]).length))}}return d}});a.extend({rating:{_rating:".rating",init:function(c){c=(c||5)+1;a(this._rating).each(function(){var h=a(this);var f=parseInt(h.attr("data-star")||0);var e="",g="";for(var d=1;d<c;d++){if(f>0&&d<=f){g="active"}e+='<i class="fa fa-star-o '+g+'"></i> ';g=""}h.html(e);if(h.hasClass("ignore")){return}var j=h.find("i");j.each(function(){a(this).mouseover(function(){j.each(function(){a(this).removeClass("active")});a(this).addClass("active");var k=a(this).prevAll();k.each(function(){a(this).addClass("active")})})});h.on("click","i",function(){var l=a(this).prevAll();var k=l.length+1})})}}});a.extend({bubble:{_tip:["努力奋斗","分秒必争","自强不息","持之以恒","百花齐放","永无止境","苦心孤诣","穷则思变","一马当先","精益求精","全力以赴","甘之如饴","百尺竿头","当仁不让"],init:function(){var c=0;a("body").click(function(h){c=c>=a.bubble._tip.length?0:c;if(!h.originalEvent){return}var d=h.originalEvent.x||h.originalEvent.layerX||0;var j=h.originalEvent.y||h.originalEvent.layerY||0;var f='<span style="position: fixed;z-index:9999;left: '+d+"px;top: "+j+'px;"></span>';var g=a(f).appendTo(a(this));g.effectBubble({y:-100,className:"thumb-bubble",fontSize:0.5,content:'<i class="fa fa-smile-o"></i>'+a.bubble._tip[c]});setTimeout(function(){g.remove()},1002);c++})},unbind:function(c){a("body").unbind("click");if(c&&!isNaN(c=parseInt(c))){setTimeout(function(){a.bubble.init()},c)}}}});a.fn.extend({effectBubble:function(c){var d=a.extend({content:"+1",y:-100,duration:1000,effectType:"ease",className:"",fontSize:2},c);return this.each(function(){var j=a(this),f="effect-fly-"+(new Date().getTime());var e='<span id="#flyId#" class="effect-bubble-fly #class#" style="opacity: 1;top:#top#px;left:#left#px;font-size: #fontSize#rem;">#content#</span>';var g=e.replaceAll("#left#",12).replaceAll("#top#",-8).replaceAll("#flyId#",f).replaceAll("#content#",d.content).replaceAll("#class#",d.className).replaceAll("#fontSize#",d.fontSize);var h=a(g).appendTo(j);h.fadeIn(100,"swing",function(){h.animate({top:d.y,opacity:0},100,function(){h.fadeOut(d.duration,function(){h.remove()})})})})}});a.fn.extend({pagination:function(c){return this.each(function(){var e=a(this);var j=new b(c);var f=a('<ul class="pager page-btn"></ul>');f.appendTo(e);var k='<li><a class="pointer #active#" data-page="#pageNum#">#pageNum#</a></li>';var d=j.getInterval();var h="";if(j.hasPrev()){h+='<li><a class="pointer" data-page="'+j.opts.pre+'"><i class="fa fa-angle-double-left"></i></a></li>'}for(var g=d.start;g<d.end;g++){h+=k.replaceAll("#pageNum#",g).replaceAll("#active#",j.opts.currentPage===g?"active":"")}if(j.hasNext()){h+='<li><a class="pointer" data-page="'+j.opts.next+'"><i class="fa fa-angle-double-right"></i></a></li>'}f.html(h);f.find("li > a").on("click",function(){var l=a(this).data("page")||1;if(!l){return}if(j.opts.search){a("#searchForm").find("input[name=pageNumber]").val(l);a(".nav-search-btn").click()}else{window.location.href=j.opts.url+"/"+l}})})}});var b=function(c){this.opts=a.extend({url:"",search:"",totalPage:0,currentPage:1,showNumPage:7,pre:-1,next:-1},c)};a.extend(b.prototype,{getInterval:function(){var f=Math.ceil(this.opts.showNumPage/2);var e=this.opts.totalPage;var d=e-this.opts.showNumPage;var g=this.getCurrentPage()>f?Math.max(Math.min(this.getCurrentPage()-f,d),0):0;var c=this.getCurrentPage()>f?Math.min(this.getCurrentPage()+f,e):Math.min(this.opts.showNumPage,e);return{start:g+1,end:c+1}},getCurrentPage:function(){var c=parseInt(this.opts.currentPage);return isNaN(c)?1:c},hasPrev:function(){return this.opts.pre&&this.opts.pre>0},hasNext:function(){return this.opts.next&&this.opts.next>0&&this.opts.next<=this.opts.totalPage}})})(jQuery);(function(a){a.fn.toTop=function(c){var d=this;var f=a(window);var e=a("html, body");var b=c;if(!b){b=a.extend({autohide:true,offset:100,speed:500,right:15,bottom:50},c)}d.css({position:"fixed",right:b.right,bottom:b.bottom,cursor:"pointer"});if(b.autohide){d.css("display","none")}d.click(function(){e.animate({scrollTop:0},b.speed)});f.scroll(function(){var g=f.scrollTop();if(b.autohide){if(g>b.offset){d.fadeIn(b.speed)}else{d.fadeOut(b.speed)}}})}})(jQuery);(function(a){a.fn.textSlider=function(b){b=jQuery.extend({speed:"normal",line:2,timer:3000},b);return this.each(function(){a.fn.textSlider.scllor(a(this),b)})};a.fn.textSlider.scllor=function(h,d){var g=a("ul:eq(0)",h);var j;var l=g.children();var e=a(l[0]).height();var k=0-d.line*e;var c=function(){g.animate({marginTop:k},d.speed,function(){for(i=0;i<d.line;i++){g.find("li:first",h).appendTo(g)}g.css({marginTop:0})})};var f=function(){j=window.setInterval(c,d.timer)};var b=function(){window.clearInterval(j)};g.hover(b,f).mouseout()}})(jQuery);jQuery(document).ready(function(){function h(){var a=appConfig.dynamicTitle;a=a?a+" | ":"";document.title=document[f]?a+g+"":g}var f,e,g=document.title;"undefined"!=typeof document.hidden?(f="hidden",e="visibilitychange"):"undefined"!=typeof document.mozHidden?(f="mozHidden",e="mozvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(f="webkitHidden",e="webkitvisibilitychange");"undefined"==typeof document.addEventListener&&"undefined"==typeof document[f]||document.addEventListener(e,h,!1)});function initNavbar(){$(".navbar .navbar-nav li").each(function(){var a=$(this);if(a.hasClass("dropdown")){a.on("mouseover",function(){a.addClass("open").find("a:first-child").attr("aria-expanded","true")}).on("mouseout",function(){a.removeClass("open").find("a:first-child").attr("aria-expanded","false")})}a.find("a").each(function(){var c=$(this);var b=c.parent();b.removeClass("active");if(c.attr("href")===$.tool.currentPath()){b.toggleClass("active")}})})}function initArticeMenu(){$(function(){var g=$(".blog-info-body");var j=g.find("h2, h3");var h=$(".article-module");var b=$("#article-menu");if(g&&g[0]){var f=[0,10,20,30,40];var d,a;var e=false;$(window).scroll(function(){var m=$(document).scrollTop();var k="";j.each(function(){var n=$(this);if(m>n.offset().top-200){k="#"+n.prev().attr("id")}else{return false}});var l=b.find(".active");if(k&&l.attr("href")!=k){l.removeClass("active");b.find("[href="+k+"]").parent().addClass("active")}});j.each(function(k){var n=$(this);var o=n.text().trim();var l=n[0].tagName.toLowerCase();var m=parseInt(l.charAt(1))-1;n.addClass("menu-title").before($('<span id="menu_'+k+'" class="menu-point"></span>'));a='<a href="#menu_'+k+'" style="display:inline-block;"><i class="fa fa-anchor"></i>  '+o+"</a>";d='<li style="padding-left:'+f[m]+'px;">'+a+"</li>";b.find("ul").append(d);e=true});if(e){b.show();h.removeClass("hide");c(),$(window).scroll(function(){c()});function c(){h.css("display",($(window).width()<768)?"none":"block");if($(window).width()<768){return false}if($.tool.currentPath().indexOf("/article/")!==-1){if($(document).scrollTop()>=200){if(!h.hasClass("fixed")){h.addClass("fixed").css({width:"25.2%"}).animate({top:"85px"},100);$(".close-article-menu").removeClass("hide")}}else{h.removeClass("fixed").removeAttr("style");$(".close-article-menu").addClass("hide")}}}$(".close-article-menu").click(function(){h.addClass("hide")})}}})}function initScrollMenu(){var f=$("#topmenu");var b=$("#mainmenu");var d=$(window);var e=$(document);var c=$(".article-module");a();d.scroll(function(){a()});function a(){if(e.scrollTop()>=100){if(!b.hasClass("transparent")){f.animate({opacity:"0"},0);b.addClass("transparent");if(d.width()>768){b.animate({top:"0","z-index":1000},1)}}}else{f.animate({opacity:"1"},0);b.removeClass("transparent");if(d.width()>768){b.animate({top:"30","z-index":998},1)}}}}var PaymentUtils=window.payment||{config:[{url:appConfig.zfbPraiseCode,desc:"支付宝转账"},{url:appConfig.wxPraiseCode,desc:"微信转账"}],show:function(){$("#reward").modal("show");this.change(0);$("#reward input").on("ifChecked",function(b){var a=$(this).data("index");PaymentUtils.change(a)})},hide:function(){$("#reward").modal("hide")},change:function(b){var a=this.config[b];$("#qrcode-container").empty();$('<img  src="'+a.url+'" style="width: 250px;height: auto;" alt="'+a.desc+'">').appendTo($("#qrcode-container"))}};var wesocketMsgResolver={online:function(a){a&&$(".online").html(a)},notification:function(a){a&&$.notification.show({notification:a})}};$(function(){$(document).ready(function(){NProgress.start()});$(window).load(function(){NProgress.done()});$(document).ajaxStart(function(){NProgress.start()}).ajaxStop(function(){NProgress.done()});initNavbar();initArticeMenu();initScrollMenu();$(".to-top").toTop({autohide:true,offset:100,speed:500,right:25,bottom:50});$("[data-toggle='tooltip']").tooltip();$('[data-toggle="popover"]').popover();$(".showImage").fancybox();if($("#scrolldiv")){$("#scrolldiv").textSlider({line:1,speed:300,timer:5000})}if($.rating){$.rating.init(5)}if($.bubble){$.bubble.init()}b(),setInterval(function(){b()},1000);function b(){var g=new Date();var f=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"];$("#currentTime").html(g.format("yyyy年MM月dd日 hh时mm分ss秒")+" "+f[g.getDay()])}if($.websocket){var d=appConfig.cmsPath;var a={"http://":"ws://","https://":"wss://"};var e,c;$.each(a,function(g,f){if(d.startsWith(g)){c=f;e=d.replaceAll(g,"");return false}});e=e||document.domain+":8085";if(e){$.notification.requestPermission();$.websocket.open({host:c+e+"/websocket",reconnect:true,callback:function(g){var f=JSON.parse(g);wesocketMsgResolver[f.fun](f.msg)}})}else{console.warn("网站host获取失败，将不启动webscoket。")}}$(".showContent").click(function(){$(this).toggleClass("fa-plus-square fa-minus-square");$(".disable-content").slideToggle(400)});if(/iphone|ipod|ipad|ipad|mobile/i.test(navigator.userAgent.toLowerCase())){$(".share-sd").click(function(){$("#share").animate({opacity:"toggle",top:"-80px"},500).animate({top:"-60px"},"fast");return false})}else{$(".share-sd").mouseover(function(){$(this).children("#share").show()});$(".share-sd").mouseout(function(){$(this).children("#share").hide()})}$("#social .like").click(function(){var h=$(this);var g=$(this).find("a");var f=g.find("i.count");var j=g.data("id");$.bubble.unbind();$.ajax({type:"post",url:"/api/doPraise/"+j,success:function(k){$.alert.ajaxSuccess(k);if(k.status===200){h.effectBubble({y:-80,className:"thumb-bubble",fontSize:1,content:'<i class="fa fa-smile-o"></i>+1'});f.text(parseInt(f.text())+1)}$.bubble.init()},error:function(){$.alert.ajaxError();$.bubble.init()}})});if(appConfig.lazyloadPath){$("img.lazy-img").lazyload({placeholder:appConfig.lazyloadPath,effect:"fadeIn",threshold:100});$(window).bind("load",function(){var f=setTimeout(function(){$("img.lazy-img").trigger("sporty")},3000)})}$(".search-hot li").click(function(){var f=$(this);var g=f.find("a span").text();f.parents(".searchForm").find("input[name=keywords]").val(g);f.parents(".searchForm").find(".nav-search-btn").click()});$(".pagination").each(function(){var f=$(this);f.pagination({url:f.data("url"),search:f.data("search"),totalPage:f.data("total-page"),currentPage:f.data("current-page"),pre:f.data("pre")||-1,next:f.data("next")||-1})});if($("#notice-box")&&$("#notice-box")[0]){$.ajax({type:"post",url:"/api/listNotice",success:function(h){if(h.status==200&&h.data&&h.data.length>0){var f='{{#data}}<li class="scrolltext-title"><a href="javascript:void(0)" rel="bookmark">{{&content}}</a></li>{{/data}}';var g=Mustache.render(f,h);$("#notice-box").html(g)}},error:function(){$.alert.ajaxError()}})}$("#myCarousel").mouseover(function(){$(".carousel-control").removeClass("hide")}).mouseout(function(){$(".carousel-control").addClass("hide")}).carousel({interval:5000});if($.comment){$.comment.init({placeholder:appConfig.editorPlaceholder||"说点什么吧",wmName:appConfig.siteName,wmUrl:appConfig.wwwPath,wmDesc:appConfig.editorAlert||"讲文明、要和谐"});$("#comment-form-btn").click(function(){$.comment.submit($(this))})}});var _form={valid:function(b){var a=true;$(b).find("small").each(function(){if($(this).attr("data-bv-result")=="INVALID"){a=false}});return a}};$.extend({comment:{detailKey:"comment-detail",sid:0,_commentDetailModal:"",_detailForm:"",_detailFormBtn:"",_closeBtn:"",_commentPid:"",_commentPlace:"",_commentPost:"",_cancelReply:"",_commentReply:"",_simplemde:null,initDom:function(){$.comment._commentDetailModal=$("#comment-detail-modal");$.comment._detailForm=$("#detail-form");$.comment._detailFormBtn=$("#detail-form-btn");$.comment._closeBtn=$("#comment-detail-modal .close");$.comment._commentPid=$("#comment-pid");$.comment._commentPlace=$("#comment-place");$.comment._commentPost=$("#comment-post");$.comment._cancelReply=$("#cancel-reply");$.comment._commentReply=$(".comment-reply")},init:function(b){var c=$("#comment-box");if(!c||!c[0]){return}var d=$.extend({},b);var a='<div id="comment-place"><div class="comment-post" id="comment-post" style="position: relative"><h5 class="custom-title"><i class="fa fa-commenting-o fa-fw icon"></i><strong>评论</strong><small></small></h5><form class="form-horizontal" role="form" id="comment-form"><div class="cancel-reply" id="cancel-reply" style="display: none;"><a href="javascript:void(0);" onclick="$.comment.cancelReply(this)" rel="external nofollow"><i class="fa fa-share"></i>取消回复</a></div><input type="hidden" name="pid" id="comment-pid" value="0" size="22" tabindex="1"><textarea id="comment_content" class="form-control col-md-7 col-xs-12 valid" style="display: none"></textarea><textarea name="content" style="display: none"></textarea><div style="position: absolute;right: 10px;bottom: 70px;font-size: 14px;color: #dbdada;z-index: 1;">'+d.wmName+"<br>"+d.wmUrl+"<br>"+d.wmDesc+'</div><a id="comment-form-btn" type="button" data-loading-text="正在提交评论..." class="btn btn-default btn-block">提交评论</a></form></div></div>';c.html(a);$.comment.initDom();this._simplemde=$.comment.createEdit(d);$.comment.loadCommentList(c);$.comment.initValidatorPlugin()},createEdit:function(b){var a=new SimpleMDE({element:document.getElementById("comment_content"),toolbar:["bold","italic","|","code","quote","|","preview","|","guide"],autoDownloadFontAwesome:false,placeholder:b.placeholder||"说点什么吧",renderingConfig:{codeSyntaxHighlighting:true},tabSize:4});a.codemirror.on("change",function(){$("textarea[name=content]").val(a.markdown(a.value()))});return a},loadCommentList:function(c,b){var a=c.attr("data-id");if(!a){throw"未指定sid！"}this.sid=a;$.ajax({type:"post",url:"/api/comments",data:{sid:a,pageNumber:b||1},success:function(m){$.alert.ajaxSuccess(m);var h=m.data.commentList;var g="";if(!h){g='<div class="commentList"><h5 class="custom-title"><i class="fa fa-comments-o fa-fw icon"></i><strong>0 评论</strong><small></small></h5><ul class="comment">';g+='<li><div class="list-comment-empty-w fade-in"><div class="empty-prompt-w"><span class="prompt-null-w">还没有评论，快来抢沙发吧！</span></div></div></li>';g+="</ul></div>";$(g).appendTo(c)}else{if(!b){g='<div class="commentList"><h5 class="custom-title"><i class="fa fa-comments-o fa-fw icon"></i><strong>'+m.data.total+' 评论</strong><small></small></h5><ul class="comment">'}for(var e=0,j=h.length;e<j;e++){var f=h[e];var d=f.url||"javascript:void(0)";var l=f.parent;var n="";if(f.root){n='<img src="/img/author.png" alt="" class="author-icon" title="管理员">'}var k=l?'<a href="#comment-'+l.id+'" class="comment-quote">@'+l.nickname+'</a><div style="background-color: #f5f5f5;padding: 5px;margin: 5px;border-radius: 4px;"><i class="fa fa-quote-left"></i><p></p><div style="padding-left: 10px;">'+filterXSS(l.content)+"</div></div>":"";g+='<li>    <div class="comment-body fade-in" id="comment-'+f.id+'">        <div class="cheader">           <div class="user-img">'+n+'<img class="userImage" src="'+filterXSS(f.avatar)+'" onerror="this.src=\''+appConfig.staticPath+'/img/user.png\'"></div>           <div class="user-info">              <div class="nickname">                 <a target="_blank" href="'+d+'" rel="external nofollow"><strong>'+f.nickname+'</strong></a>                <i class="icons os-'+f.osShortName+'" title="'+f.os+'"></i>                <i class="icons browser-'+f.browserShortName+'" title="'+f.browser+'"></i>              </div>                         <div class="timer">                  <i class="fa fa-clock-o fa-fw"></i>'+f.createTimeString+'                  <i class="fa fa-map-marker fa-fw"></i>'+f.address+'              </div>          </div>        </div>        <div class="content">'+k+"<div>"+filterXSS(f.content)+'</div></div>        <div class="sign">            <a href="javascript:void(0);" class="comment-up" onclick="$.comment.praise('+f.id+', this)"><i class="fa fa-thumbs-o-up"></i>赞(<span class="count">'+f.support+'</span>)<i class="sepa"></i></a>            <a href="javascript:void(0);" class="comment-down" onclick="$.comment.step('+f.id+', this)"><i class="fa fa-thumbs-o-down"></i>踩(<span class="count">'+f.oppose+'</span>)<i class="sepa"></i></a>            <a href="javascript:void(0);" class="comment-reply" onclick="$.comment.reply('+f.id+', this)"><i class="fa fa-reply"></i>回复</a>            <a href="javascript:void(0);" class="comment-flag hide" onclick="$.comment.report('+f.id+', this)"><i class="fa fa-flag"></i>举报</a>        </div>    </div></li>'}if(m.data.hasNextPage){g+='<li><div class="list-comment-empty-w fade-in"><div class="empty-prompt-w"><span class="prompt-null-w pointer load-more">加载更多 <i class="fa fa-angle-double-down"></i></span></div></div></li>'}if(!b){g+="</ul></div>";$(g).appendTo(c)}else{$(g).appendTo($(".comment"))}$(".load-more").click(function(){$(this).parents("li").hide();$.comment.loadCommentList(c,m.data.nextPage)})}},error:$.alert.ajaxError})},initValidatorPlugin:function(){$.comment._detailForm.bootstrapValidator({message:"输入值无效",feedbackIcons:{valid:"fa fa-check",invalid:"fa fa-remove",validating:"fa fa-refresh"},fields:{nickname:{validators:{notEmpty:{message:"昵称必填"}}},url:{validators:{uri:{message:"URL地址不正确"}}},email:{validators:{emailAddress:{message:"邮箱地址不正确"}}}}})},submit:function(g){var f=$(g);f.button("loading");var d=$("#comment-form").serialize();if(!oauthConfig.loginUserId){var c=localStorage.getItem(this.detailKey);if(!c){}else{var e=$.tool.parseFormSerialize(c);$.comment._detailForm.find("input").each(function(){var j=$(this);var h=j.attr("name");if(e[h]){j.val(e[h])}});var b=$.comment._detailForm.find("img");b.attr("src",e.avatar);b.removeClass("hide")}this._commentDetailModal.modal("show");this._closeBtn.unbind("click");this._closeBtn.click(function(){setTimeout(function(){f.html("<i class='fa fa-close'></i>取消操作...");setTimeout(function(){f.button("reset")},1000)},500)});this._commentDetailModal.find(".modal-content").addClass("shake");$.comment._detailForm.find("input[name=qq]").unbind("change");$.comment._detailForm.find("input[name=qq]").change(function(){var k=$(this);var h=k.val();var j=k.next("img");if(h){$.ajax({type:"post",url:"/api/qq/"+h,success:function(l){$.alert.ajaxSuccess(l);var m=l.data;$.comment._detailForm.find("input").each(function(){var o=$(this);var n=o.attr("name");if(m[n]){o.val(m[n])}});j.attr("src",m.avatar);j.removeClass("hide")},error:$.alert.ajaxError})}else{j.addClass("hide")}});this._detailFormBtn.unbind("click");this._detailFormBtn.click(function(){$.comment._detailForm.bootstrapValidator("validate");if(_form.valid($.comment._detailForm)){d=d+"&"+$.comment._detailForm.serialize();localStorage.setItem($.comment.detailKey,$.comment._detailForm.serialize());a(d)}})}else{a(d)}function a(h){console.log(h);$.ajax({type:"post",url:"/api/comment",data:h+"&sid="+$.comment.sid,success:function(j){$.alert.ajaxSuccess(j);$.comment._commentDetailModal.modal("hide");setTimeout(function(){f.html("<i class='fa fa-check'></i>"+j.message);setTimeout(function(){f.button("reset");if(j.status==200){window.location.reload()}},3000)},1000)},error:function(j){$.alert.ajaxError();f.button("reset")}})}},reply:function(a,b){this._commentPid.val(a);this._cancelReply.show();$(b).hide();$(b).parents(".comment-body").append($("#comment-form"))},cancelReply:function(a){this._commentPid.val("");this._cancelReply.hide();$(a).parents(".comment-body").find(".comment-reply").show();this._commentPost.append($("#comment-form"))},praise:function(a,b){$.bubble.unbind();$.ajax({type:"post",url:"/api/doSupport/"+a,success:function(d){$.alert.ajaxSuccess(d);if(d.status==200){$(b).effectBubble({y:-80,className:"thumb-bubble",fontSize:1,content:'<i class="fa fa-smile-o"></i>+1'});var c=$(b).find("span.count").text();$(b).find("span.count").text(parseInt(c)+1)}$.bubble.init()},error:function(){$.alert.ajaxError();$.bubble.init()}})},step:function(a,b){$.bubble.unbind();$.ajax({type:"post",url:"/api/doOppose/"+a,success:function(d){$.alert.ajaxSuccess(d);if(d.status==200){$(b).effectBubble({y:-80,className:"thumb-bubble",fontSize:1,content:'<i class="fa fa-meh-o"></i>+1'});var c=$(b).find("span.count").text();$(b).find("span.count").text(parseInt(c)+1)}$.bubble.init()},error:function(){$.alert.ajaxError();$.bubble.init()}})},report:function(a,b){}}});